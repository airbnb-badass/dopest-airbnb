<h1>Your profile :</h1>

<p>Your email is : <%= current_user.email %></p>

<%= link_to "Edit profile", edit_user_registration_path %>

<h2>Your apartments :</h2>

<% if current_user.apartments.size > 0 %>

  <table class="table">

    <thead>
      <tr>
        <th>Title</th>
        <th>Edit</th>
        <th>Destroy</th>
        <th>Photos</th>
        <th>Bookings</th>
      </tr>
    </thead>

    <tbody>

  <% current_user.apartments.each do |apartment| %>
      <tr>
        <td><%= link_to apartment.title, apartment_path(apartment)%></td>
        <td><%= link_to "edit", edit_apartment_path(apartment)%></td>
        <td> <%= link_to "destroy", apartment_path(apartment), method: :delete%></td>
        <td> <%= link_to "manage photos", apartment_pictures_path(apartment)%></td>
        <% if apartment.bookings.any? %>
          <td> <%= link_to "View bookings", apartment_bookings_path(apartment)%></td>
          <% else %>
            <td>No booking yet !</td>
          <% end %>
      </tr>
    <% end %>

    </tbody>

  </table>

<% else %>
You don't have any apartment ?! <%= link_to 'list it now' , new_apartment_path %>
<% end %>


<h2>3 lasts bookings on your apartments :</h2>

<table class="table">

  <thead>
    <tr>
      <th>Apartment</th>
      <th>Checkin</th>
      <th>Checkout</th>
      <th>Guests</th>
      <th>status</th>
    </tr>
  </thead>

  <tbody>

  <% current_user.apartment_bookings.first(3).each do |booking| %>
    <tr>
      <td><%= booking.apartment_id %></td>
      <td><%= booking.checkin %></td>
      <td><%= booking.checkout %></td>
      <td><%= booking.guests %></td>
      <td><%= booking.status %></td>
    </tr>
  <% end %>

  </tbody>
</table>

<%= link_to 'View all bookings on your apartments' , bookings_path %>

<h2>My bookings for my next holidays :</h2>
<table class="table">

    <thead>
      <tr>
        <th>Apartment</th>
        <th>Checkin</th>
        <th>Checkout</th>
        <th>Guests</th>
      </tr>
    </thead>

    <tbody>

  <% current_user.bookings.each do |booking| %>
      <tr>
        <td><%= booking.apartment_id %></td>
        <td><%= booking.checkin %></td>
        <td><%= booking.checkout %></td>
        <td><%= booking.guests %></td>
      </tr>
    <% end %>

    </tbody>

  </table>


